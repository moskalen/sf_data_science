# Проект 4. Предсказание стоимости домов на основе истории предложений

## Оглавление
[1. Описание проекта](README.md#Описание-проекта)

[2. Инструкция для проверки проекта](README.md#Инструкция-для-проверки-проекта)

[3. Краткая информация о данных](README.md#Краткая-информация-о-данных)

[4. Этапы работы над проектом](README.md#Этапы-работы-над-проектом)

[5. Результаты](README.md#Результаты)

### Описание проекта
Разработать сервис для предсказания стоимости домов на основе истории предложений.

:arrow_up:[ к оглавлению](README.md#Оглавление)


### Инструкция для проверки проекта

1. Скопируйте проект `final/`
    > Можно клонировать весь репозиторий:
    ```
    git clone git@github.com:moskalen/sf_data_science.git
    cd sf_data_science/final
    ```

2. Загрузите [архив с данными](https://drive.google.com/file/d/1q69tRQkLCEWp4Th5jmU8jfHqehklpqE4/view?usp=sharing) и скопируйте его в папку `final/data/`.

    ***Раскрывать архив не надо.***

3. Загрузите [`requirements.txt`](requirements.txt)

    ```
    pip install -r requirements.txt
    ```

4. По очереди запустите на выполнение ноутбуки:
    * [main.ipynb](main.ipynb)
        > После выполения в папке `data/` появится файл `data1.csv` c преобразованными данными
    * [main2.ipynb](main2.ipynb)
        > этот ноутбук работал около часа на MacBook Pro с процессором M1 Max и 64G памяти

        > после выполнения в папке `web/app/models/` появится файл с моделью и энкодерами `model_and_encoders.pkl`

5. В результате работы ноутбуков в папке `web/app/models/` появится файл с моделью и энкодерами `model_and_encoders.pkl`.

    Эту модель [можно сразу скачать](https://drive.google.com/file/d/18u-vDZ8bcpsP1PzDH2Sknm3kKjrebzJM/view?usp=sharing) и скопировать в папку `web/app/models/`.

6. Проверить работу сервиса можно [по этой инструкции](install.md).

### Краткая информация о данных

* 'status' - статус продажи
* 'private pool’ и 'PrivatePool' - наличие частного бассейна,
* 'propertyType' - тип недвижимости, поместья, свойства,
* 'street' - адрес дома
* 'baths' - количество ванных комнат
* 'homeFacts' - сведения о строении дома, содержит несколько отдельных данных, имеющих влияние на оценку недвижимости, дома, квартиры
* 'fireplace' - сведения о наличии камина (ов) в доме
* 'city' - город
* 'schools' - сведения о школах в районе
* 'sqft' - площадь дома в футах
* 'zipcode' - почтовый индекс
* 'beds' - количество спален в доме
* 'state' - государство/штаты
* 'stories' - этажность недвижимости
* 'mls-id' и 'MlsId' - идентификатор MLS (Multiple Listing Service - Служба множественного листинга)
* 'target' - целевой признак, который необходимо спрогнозировать - цена недвижимости

:arrow_up:[ к оглавлению](README.md#Оглавление)


### Этапы работы над проектом

1. [Знакомство с данными, обработка пропусков](main.ipynb)
1. [Анализ данных, удаление выбросов](main2.ipynb#)
1. [Построение модели](main2.ipynb#Построение+модели)
1. [Подготовка модели для работы на проде](model.ipynb)
1. [Установка веб-приложения для предсказания цены](install.md)

:arrow_up:[ к оглавлению](README.md#Оглавление)


### Результаты:

* Выбрана модель `CatBoostRegressor` с использованием библиотеки `optuna` и отдельной валидационной выборки для подбора гиперпараметров

* Таблица с рассмотренными моделями:
    |Модель                           | Train $R^2$ | Train MAE | Test $R^2$ | Test MAE | Test MAPE |
    |---------------------------------|-------------|-----------|------------|----------|-----------|
    | LinearRegression                | 0.370       | 0.641     | 0.369      | 0.635    | 5.312     |
    | Polynomial Regression           | 0.616       | 0.479     | 0.611      | 0.475    | 3.987     |
    | DecisionTreeRegressor           | 0.568       | 0.514     | 0.563      | 0.511    | 2.912     |
    | RandomForestRegressor           | 0.687       | 0.423     | 0.674      | 0.428    | 2.225     |
    | CatBoostRegressor               | 0.807       | 0.310     | 0.795      | 0.314    | 2.671     |
    | CatBoostRegressor (optuna)      | 0.855       | 0.263     | 0.822      | 0.282    | 2.445     |
    | CatBoostRegressor (optuna, val) | 0.863       | 0.255     | 0.823      | 0.281    | 2.388     |

:arrow_up:[ к оглавлению](README.md#Оглавление)
